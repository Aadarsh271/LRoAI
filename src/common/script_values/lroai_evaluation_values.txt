# How supplied a market is with a good. Lower levels means undersupply.
# Using default price formula to illustrate:
# Level 1 is shortage >75%
# Levels 2-11 go from +75% to 0%
# Levels 12-21 go from 0% to -75%
# Level 22 is excess <-75%
lroai_supply_vs_demand_level = {
    if = {
        limit = {
            market_goods_buy_orders <= 0
        }
        value = 99
    }
    else = {
        if = {
            limit = {
                market_goods_sell_orders <= 0
            }
            value = 1
        }
        else = {
            value = 22
            subtract = {
                if = {
                    limit = {
                        market_goods_buy_orders > market_goods_sell_orders
                    }
                    value = market_goods_buy_orders
                    divide = market_goods_sell_orders
                    divide = {
                        value = define:NEconomy|BUY_SELL_DIFF_AT_MAX_FACTOR
                        subtract = 1
                        min = 1
                    }
                    multiply = 10
                    ceiling = yes
                    min = 11
                    max = 21
                }
                else = {
                    value = 20
                    subtract = {
                        value = market_goods_sell_orders
                        divide = market_goods_buy_orders
                        divide = {
                            value = define:NEconomy|BUY_SELL_DIFF_AT_MAX_FACTOR
                            subtract = 1
                            min = 1
                        }
                        multiply = 10
                        floor = yes
                        min = 10
                        max = 20
                    }
                }
            }
        }
    }
}


# When military forces are being used, we limit construction of military buildings case demand is higher than usual
lroai_max_level_when_using_military_forces = 6

# ----------------------------------------------
# General info about government building targets
# ----------------------------------------------

# Government buildings don't produce goods in most cases, so you can't judge them by productivity or whatever, you need
# to establish some special measure of how important are they and how much of them a country needs. To solve this two
# values are introduced for each government building, share and target.

# Share is % of budget income of a country that it can spend on this building weekly to pay for wages and input good.
# Usually it's pretty rigid, roughly set to what works the best, but with some dynamic factors added in more cases.
# For example, government administration share is higher when tax capacity is low country-wide. Construction sector
# is special in a sense that it has no base or fixed share, instead it just takes all what's left after other shares.
# Please note that for AI shares are always calculated for normal tax and wage level, otherwise it would be unstable.
# Again consruction sector are special here, they always assume high tax level at the beginning for faster development
# of economy, but when a country won't have much free workforce left, sector will demand less and less money, down to
# normal tax level and even a bit below it.

# Target is arbitrary value on how much stuff a country wants to have, be it spare bureaucracy, innovation, battalions,
# convoys, everything. Except construction sectors, of course. They have no target. Anyways, targets are calculated by
# some random ass formulas, most of the time in some form of population multiplied by some form of GDP per capita, with
# a bunch of other factors thrown in. If country is below target, but expenses already exceed share, it won't construct
# more in most cases, so share acts as a limiter. If country reached target but not share, it may build some more of
# this building cause why not if they are rich enough for that.

# --------------------------------------------------------------
# Various common factors that affect government building targets
# --------------------------------------------------------------

# Square GDP per capita of incorporated population + half unincorporated population multiplied by some factor. This is
# basically what we believe to be a relation between growth of GDP per capita and government building targets, in other
# words a factor of us being a rich or not so rich country vs how much good stuff we want to have.
lroai_target_minus_half_unincorporated_gdp_per_capita_scaling = {
    value = var:lroai_square_root_of_minus_half_unincorporated_gdp_per_capita
    multiply = 3
    divide = 4
    add = {
        value = 1
        divide = 4
    }
}

# If a country is forced to spend most of its money on government administrations, we need to lower other shares
lroai_target_multiplier_with_high_government_spending = {
    value = 1
    subtract = {
        value = {
            value = lroai_building_government_administration_spending_value
            divide = lroai_country_active_income
        }
        divide = {
            value = lroai_building_government_administration_spending_share
            multiply = 1.20
        }
        subtract = 1
        min = 0
        max = 0.75
    }
}


# If construction is largely sponsored by investment pool, we want to raise non-construction shares
lroai_target_multiplier_with_investment_pool = {
    value = 1.00
    add = {
        value = 1.20
        multiply = {
            value = lroai_investment_pool_expected
            divide = lroai_country_active_income
            divide = 0.30
            min = 0
            max = 1
        }
    }
}

